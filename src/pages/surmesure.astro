---
import Layout from '../layouts/Layout.astro';
import { Image } from "astro:assets";

// Import des images locales des étapes et du hero
import atelierImg from '../assets/images/images/atelier.png';
import etudeBesoinImg from '../assets/images/images/etude-besoin.png';
import printerImg from '../assets/images/images/printer.png';
import acetateImg from '../assets/images/images/acetate.png';
import craftImg from '../assets/images/images/craft.png';
import reglageImg from '../assets/images/images/reglage.png';

const steps = [
  {
    icon: "message-circle",
    title: "Rencontre & étude du besoin",
    description: "Un premier échange afin d'échanger autour de votre besoin, de vos goûts et préférences, prise de mesures et définition du style.",
    img: etudeBesoinImg,
  },
  {
    icon: "3d-printer",
    title: "Prototype 3D",
    description: "Création et impression d’un prototype 3D pour valider la forme et la taille de la monture.",
    img: printerImg,
  },
  {
    icon: "materials",
    title: "Choix des couleurs",
    description: "Sélection parmi un large choix de couleurs pour la façade et les branches de votre futur paire de lunettes, aux finitions variées et adaptées à vos envies.",
    img: acetateImg,
  },
  {
    icon: "gear",
    title: "Fabrication artisanale",
    description: "Découpe, polissage, assemblage et contrôle qualité par nos soins dans notre atelier !",
    img: craftImg,
  },
  {
    icon: "glasses",
    title: "Réglages & réception",
    description: "Ajustements et contrôle final pour un confort optimal avant que vous ne preniez réception de votre nouvelle paire de lunettes unique.",
    img: reglageImg,
  },
];

function getIcon(icon) {
  switch (icon) {
    case "message-circle": return `<img src="/src/assets/images/icons/message-circle.svg" alt="Bulle" class="h-8 w-8 inline-block align-middle" />`;
    case "3d-printer": return `<img src="/src/assets/images/icons/3d-printer.svg" alt="Imprimante 3D" class="h-8 w-8 inline-block align-middle" />`;
    case "materials": return `<img src="/src/assets/images/icons/materials.svg" alt="Plaques" class="h-8 w-8 inline-block align-middle" />`;
    case "gear": return `<img src="/src/assets/images/icons/gear.svg" alt="Engenage" class="h-8 w-8 inline-block align-middle" />`;
    case "glasses": return `<img src="/src/assets/images/icons/glasses.svg" alt="Lunettes" class="h-8 w-8 inline-block align-middle" />`;
    default: return "";
  }
}
---

<Layout title="Atelier lunettes sur mesure à Cambrai | Marc & Cecile Opticien"
        description="Atelier sur mesure à Cambrai: créez vos lunettes personnalisées de A à Z avec Marc & Cecile. Artisanat, choix des matériaux et design unique.">

  <!-- === HERO SECTION === -->
  <section class="relative h-[60vh] w-full overflow-hidden">
    <Image src={atelierImg} alt="Showroom Marc & Cécile"
           class="absolute inset-0 w-full h-full object-cover" priority />
    <div class="absolute inset-0 bg-[var(--color-primary)] opacity-70"></div>

    <div class="relative z-10 flex items-center justify-center h-full container-max">
      <div class="max-w-2xl text-center text-white">
        <h1 class="text-5xl font-display mb-4 drop-shadow-lg">Votre paire de lunettes sur mesure</h1>
        <p class="text-lg text-white/90 mb-6">
          Nous créons des lunettes uniques, adaptées à votre style et à votre morphologie.
        </p>
      </div>
    </div>
  </section>

  <!-- Paragraphe d’introduction artisanat sur mesure -->
  <section class="px-4 py-8 max-w-3xl mx-auto my-auto text-center bg-white/80 rounded-xl p-8">
    <p class="text-lg text-gray-700 leading-relaxed">
      En plus de notre activité d’opticien traditionnel, nous sommes également artisans lunetiers.<br/>
      Cela signifie que nous fabriquons, en toute petite série, des collections made in Cambrai ! Toutes les montures sont
      imaginées, dessinées et réalisées directement dans notre atelier !<br/>
      Vous pouvez ainsi venir nous rencontrer avec vos idées et projets: nous concevrons pour vous une paire de lunettes
      unique, à votre taille, et qui vous ressemble parfaitement.
    </p>
  </section>

  <main class="container-max py-20 flex flex-col items-center">
    <h2 class="text-4xl font-bold text-center text-[var(--color-primary)] mb-16">Votre paire de lunettes sur mesure, étape
      par étape</h2>

    <div class="flex flex-col w-full max-w-3xl mx-auto">
      {steps.map((step, idx) => (
          <div class="flex items-stretch relative">
            {/* Timeline column */}
            <div class="relative flex flex-col items-center w-20 min-w-20 h-auto z-10">
              <div class="absolute top-0 left-1/2 -translate-x-1/2 w-2 h-full bg-[var(--color-primary)] opacity-40"></div>
              <div class="bg-white border-2 border-[var(--color-secondary)] rounded-full flex items-center justify-center h-16 w-16 z-10 mt-4">
                <div set:html={getIcon(step.icon)} />
              </div>
              {idx < steps.length - 1 && (
                  <span class="mt-4 drop-shadow">
                    <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="white" stroke-width="3"
                         stroke-linecap="round" stroke-linejoin="round">
                      <polyline points="6 10 12 16 18 10"/>
                    </svg>
                  </span>
              )}
            </div>

            {/* Section Content */}
            <div class="flex-1 flex flex-col md:flex-row md:items-center gap-8 md:ml-8">
              <div class="flex-1 py-2 bg-white/80 rounded-xl p-6">
                <h3 class="text-2xl font-bold text-[var(--color-primary)] mb-2">{step.title}</h3>
                <p class="text-gray-700 mb-2">{step.description}</p>
              </div>
              <Image src={step.img} alt={step.title} class="w-full md:w-60 h-40 object-cover rounded-lg mb-5" loading="lazy" />
            </div>
          </div>
      ))}
    </div>
  </main>
</Layout>
