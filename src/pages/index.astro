---
import Layout from '../layouts/Layout.astro';
import { Image } from "astro:assets";

// Images locales
import salleExam from "../assets/images/images/salle-exam.png";
import heroBoutique from "../assets/images/images/boutique-interieur-2.png";
import cecileImg from '../assets/images/team/cecile.png';
import marcImg from '../assets/images/team/marc.png';

// Import dynamique des logos
const rawImages = import.meta.glob("../assets/images/marques/*.{png,webp,svg,jpg,jpeg}", { eager: true });

// Mapping des logos
const brandLogos = [
  { file: "marc-et-cecile.svg", alt: "C.CILE" },
  { file: "kuboraum.webp", alt: "Kuboraum" },
  { file: "la-brique-et-la-violette.png", alt: "La brique et la violette" },
  { file: "theo.png", alt: "Theo" },
  { file: "xit.png", alt: "XIT" },
  { file: "very-french-gangsters.png", alt: "Very French Gangsters" },
];

const separatorSvgs = [
  'src/assets/images/brand/checkerboard-2.svg',
  'src/assets/images/brand/half-o.svg',
  'src/assets/images/brand/double-eyes.svg',
  'src/assets/images/brand/circle.svg',
  'src/assets/images/brand/dome.svg',
  'src/assets/images/brand/dots-2.svg',
  'src/assets/images/brand/dots.svg',
  'src/assets/images/brand/eye.svg',
  'src/assets/images/brand/logo-2.svg',
  'src/assets/images/brand/logo-3.svg',
  'src/assets/images/brand/multi-wave-2.svg',
  'src/assets/images/brand/sparkle.svg',
  'src/assets/images/brand/waves.svg',
];

const collaborators = [
  {
    name: "Cécile",
    role: "Opticienne diplômée",
    photo: cecileImg,
    desc: "Spécialiste en création de montures sur-mesure et en conseils personnalisés."
  },
  {
    name: "Marc",
    role: "Opticien",
    photo: marcImg,
    desc: "Il vous accompagne dans le choix de vos lunettes et réalise les ajustements nécessaires."
  },
];

// Fonction utilitaire pour carrousels
const createImageMap = Object.fromEntries(
    Object.entries(rawImages).map(([path, module]) => [path.split("/").pop(), module.default])
);
---

<Layout title="Opticien indépendant à Cambrai | Lunettes sur mesure – Marc & Cecile"
        description="Opticien indépendant à Cambrai, Marc & Cecile: lunettes sur mesure, lentilles de contact, montures tendance et conseils personnalisés.">

  <!-- HERO -->
  <section class="relative h-[60vh] w-full overflow-hidden">
    <Image src={heroBoutique} alt="Showroom Marc & Cécile"
           width={1600}
           height={1067} class="max-w-full absolute inset-0 w-full h-full object-cover" priority />
    <div class="absolute inset-0 bg-[var(--color-primary)] opacity-70"></div>
    <div class="relative z-10 flex items-center justify-center h-full container-max">
      <div class="max-w-2xl text-center text-white">
        <h1 class="text-5xl font-display mb-4 drop-shadow-lg">Marc & Cécile</h1>
        <p class="text-lg text-white/90 mb-6">
          Opticien artisan lunetier — showroom stylisé et fabrication sur-mesure au cœur de Cambrai.
        </p>
        <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
        <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
        <button
            type="button"
            onclick="Calendly.initPopupWidget({url: 'https://calendly.com/marcetcecile'});return false;"
            class="btn-glass-white"
        >
          Prendre rendez-vous
        </button>
      </div>
    </div>
  </section>

  <!-- BANDEAU DE LOGOS -->
  <section class="relative -mt-8 z-20 bg-white/100 backdrop-blur-sm shadow-lg rounded-xl px-8 py-4 mx-auto flex flex-wrap justify-center items-center gap-10 max-w-5xl">
    {brandLogos.map(logo => {
      const img = createImageMap[logo.file];
      if (!img) return null;
      return <Image src={img} alt={logo.alt} height={65} class="max-w-full opacity-70 hover:opacity-100 transition" loading="lazy" />;
    })}
  </section>

  <main class="relative flex flex-col items-center">
    <div class="w-full max-w-7xl px-6 md:px-10 xl:px-16">

      <!-- BOUTIQUE -->
      <section class="py-16 flex flex-col md:flex-row items-center gap-10 relative overflow-visible">
        <img src={separatorSvgs[3]} alt="Décor graphique" class="floating-svg absolute top-0 left-0 w-16 h-16 md:w-24 md:h-24 opacity-40 pointer-events-none" style="transform: translate(-40%,-40%);" />
        <div class="flex-1 text-center flex flex-col items-center justify-center bg-white/80 rounded-xl p-8">
          <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-4">La boutique</h2>
          <p class="text-gray-700 leading-relaxed max-w-prose">
            Découvrez notre boutique en plein centre de Cambrai: un espace lumineux et chaleureux, décoré par des artistes locaux.
            Notre sélection s’adapte à tous les besoins: des montures accessibles, de grandes marques créateurs, et la possibilité de concevoir votre paire unique, réalisée sur-mesure avec vous.
          </p>
        </div>
        <div class="flex-1 w-full h-80 flex items-center justify-center relative rounded-lg shadow-md overflow-hidden">
          <div id="carousel-boutique" class="relative w-full h-80">
            {["facade.png", "boutique-interieur-1.png", "boutique-interieur-2.png", "boutique-interieur-3.png"].map((file, idx) => (
                <Image
                    src={`/src/assets/images/images/${file}`}
                    alt="La boutique"
                    width={1600}
                    height={1067}
                    class="max-w-full arrousel-img absolute inset-0 m-auto object-cover rounded-lg shadow-md transition-opacity duration-700"
                    style={`opacity:${idx === 0 ? 1 : 0}; z-index:${idx === 0 ? 10 : 0}`}
                    loading="lazy"
                    data-idx={idx}
                />
            ))}
            <script type="module">
              (() => {
                const images = document.querySelectorAll('#carousel-boutique .carrousel-img');
                let current = 0;
                function show(idx) {
                  images.forEach((img, i) => {
                    img.style.opacity = i === idx ? '1' : '0';
                    img.style.zIndex = i === idx ? '10' : '0';
                  });
                }
                setInterval(() => { current = (current + 1) % images.length; show(current); }, 3500);
              })();
            </script>
          </div>
        </div>
      </section>

      <div class="w-full flex justify-center my-4">
        <img src={separatorSvgs[0]} alt="Séparateur graphique" class="h-8 md:h-12 w-auto opacity-80" loading="lazy" />
      </div>

      <!-- SALLE D’EXAMEN -->
      <section class="py-16 flex flex-col md:flex-row-reverse items-center gap-10 relative overflow-visible">
        <img src={separatorSvgs[4]} alt="Décor graphique" class="floating-svg absolute bottom-0 right-0 w-16 h-16 md:w-24 md:h-24 opacity-40 pointer-events-none" style="transform: translate(40%,40%);" />
        <div class="flex-1 text-center flex flex-col items-center justify-center bg-white/80 rounded-xl p-8">
          <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-4">Salle d’examen</h2>
          <p class="text-gray-700 leading-relaxed max-w-prose">
            Bénéficiez d’un suivi précis de votre vue grâce à notre salle d’examen entièrement équipée. Faites contrôler régulièrement votre vision pour assurer le confort optimal de vos lunettes. Nos opticiens formés réalisent votre examen de vue et le renouvellement de votre ordonnance, et vous accompagnent dans le choix de votre nouvelle monture si besoin.
          </p>
        </div>
        <Image src={salleExam} alt="Salle d’examen"
               width={1600}
               height={1067} class="max-w-full flex-1 w-full h-80 object-cover rounded-lg shadow-md" loading="lazy"/>
      </section>

      <div class="w-full flex justify-center my-4">
        <img src={separatorSvgs[1]} alt="Séparateur graphique" class="h-8 md:h-12 w-auto opacity-80" loading="lazy" />
      </div>

      <!-- NOS COLLECTIONS -->
      <section class="py-16 flex flex-col md:flex-row items-center gap-10 relative overflow-visible">
        <img src={separatorSvgs[3]} alt="Décor graphique" class="floating-svg absolute top-0 left-0 w-16 h-16 md:w-24 md:h-24 opacity-40 pointer-events-none" style="transform: translate(-40%,-40%);" />
        <div class="flex-1 text-center flex flex-col items-center justify-center bg-white/80 rounded-xl p-8">
          <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-4">Nos collections</h2>
          <p class="text-gray-700 leading-relaxed max-w-prose">
            Découvrez un large choix de marques de lunetiers, dont notre fierté: Marc & Cécile, notre collection maison, imaginée et fabriquée directement dans notre boutique à Cambrai. Nous proposons également des griffes reconnues, chacune avec une identité forte: Kuboraum, Théo, XIT, La Fabrique et La Violette.
          </p>
        </div>
        <div class="flex-1 w-full h-80 flex items-center justify-center relative rounded-lg shadow-md overflow-hidden">
          <div id="carousel-collections" class="relative w-full h-80">
            {["c-cile-1.png","kuboraum-1.png","theo-1.png","xit-1.png","la-brique-et-la-violette-1.png","c-cile-2.png","theo-2.png","xit-2.png","la-brique-et-la-violette-2.png","la-brique-et-la-violette-3.png"].map((file, idx) => (
                <Image src={`/src/assets/images/images/${file}`} alt={file}
                       width={1600}
                       height={1067} class="max-w-full carrousel-img absolute inset-0 m-auto object-cover rounded-lg shadow-md transition-opacity duration-700" style={`opacity:${idx<3?1:0}; z-index:${idx<3?10:0}`} loading="lazy" data-idx={idx} />
            ))}
            <script type="module">
              (() => {
                const images = document.querySelectorAll('#carousel-collections .carrousel-img');
                let current = 0;
                function show(idx){images.forEach((img,i)=>{img.style.opacity=i===idx?'1':'0';img.style.zIndex=i===idx?10:0;});}
                setInterval(()=>{current=(current+1)%images.length;show(current);},3500);
              })();
            </script>
          </div>
        </div>
      </section>

      <div class="w-full flex justify-center my-4">
        <img src={separatorSvgs[2]} alt="Séparateur graphique" class="h-8 md:h-12 w-auto opacity-80" loading="lazy" />
      </div>

      <!-- POUR LES PLUS JEUNES -->
      <section class="py-16 flex flex-col md:flex-row items-center gap-10 relative overflow-visible">
        <img src={separatorSvgs[3]} alt="Décor graphique" class="floating-svg absolute top-0 left-0 w-16 h-16 md:w-24 md:h-24 opacity-40 pointer-events-none" style="transform: translate(-40%,-40%);" />
        <div class="flex-1 text-center flex flex-col items-center justify-center bg-white/80 rounded-xl p-8">
          <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-4">Et pour les plus jeunes</h2>
          <p class="text-gray-700 leading-relaxed max-w-prose">
            Nous proposons une sélection spécialement conçue pour les enfants, en partenariat avec Very French Gangsters. Vous trouverez un large choix de lunettes de vue et solaires, adaptées à tous les âges, avec de nombreuses formes et couleurs pour plaire à chaque enfant.
          </p>
        </div>
        <div class="flex-1 w-full h-80 flex items-center justify-center relative rounded-lg shadow-md overflow-hidden">
          <div id="carousel-jeunes" class="relative w-full h-80">
            {["very-french-gangsters-1.png","very-french-gangsters-2.png","very-french-gangsters-3.png"].map((file,idx)=>(
                <Image src={`/src/assets/images/images/${file}`} alt="Very French Gangsters"
                       width={1600}
                       height={1067} class="max-w-full carrousel-img absolute inset-0 m-auto object-cover rounded-lg shadow-md transition-opacity duration-700" style={`opacity:${idx===0?1:0}; z-index:${idx===0?10:0}`} loading="lazy" data-idx={idx} />
            ))}
            <script type="module">
              (() => {const images=document.querySelectorAll('#carousel-jeunes .carrousel-img');let current=0;function show(idx){images.forEach((img,i)=>{img.style.opacity=i===idx?'1':'0';img.style.zIndex=i===idx?10:0;});}setInterval(()=>{current=(current+1)%images.length;show(current);},3500);})();
            </script>
          </div>
        </div>
      </section>

      <!-- ÉQUIPE -->
      <section class="container mx-auto py-16 bg-white/80 rounded-xl p-8" id="equipe">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-[var(--color-primary)] mb-12">L’équipe</h2>
        <div class="flex flex-wrap gap-10 justify-center max-w-10xl mx-auto">
          {collaborators.map(person => (
              <div class="flex flex-col items-center text-center relative group">
                <div class="relative mb-4 flex items-center justify-center">
                  {/* Cadres SVGs */}
                  <svg viewBox="0 0 130 130" class="absolute -top-5 -left-5 w-36 h-36 pointer-events-none select-none z-0" style="color: var(--color-primary, #B5838D); transform: rotate(-2deg);" fill="none" stroke="currentColor" stroke-width="4">
                    <path d="M12 22 Q8 12 22 12 L108 8 Q124 6 124 24 L120 112 Q124 124 108 124 L24 122 Q6 124 10 108 Z" stroke-linejoin="round" stroke-dasharray="7 8" />
                  </svg>
                  <svg viewBox="0 0 130 130" class="absolute -top-2 -left-2 w-36 h-36 pointer-events-none select-none z-0"
                       style="color: var(--color-secondary, #6D6875); transform: rotate(1.5deg);"
                       fill="none"
                       stroke="currentColor"
                       stroke-width="10">
                    <path d="M16 18 Q12 8 28 14 L112 12 Q122 12 120 26 L124 114 Q122 122 112 124 L26 118 Q8 122 14 112 Z"/>
                  </svg>
                  <svg viewBox="0 0 130 130" class="absolute top-0 left-0 w-36 h-36 pointer-events-none select-none z-0" style="color: var(--color-primary, #B5838D); transform: rotate(3deg);" fill="none" stroke="currentColor" stroke-width="2.3">
                    <path d="M18 19 Q15 11 25 18 L110 16 Q119 15 118 27 L121 115 Q123 125 110 123 L25 123 Q10 124 13 114 Z" stroke-dasharray="9 7" />
                  </svg>
                  <Image
                      src={person.photo}
                      alt={person.name}
                      class="max-w-full relative z-10 w-32 h-32 rounded-xl object-cover shadow-lg border-4 border-white"
                      width={200}
                      height={200}
                      loading="lazy"
                  />                </div>
                <div>
                  <h3 class="text-[var(--color-primary)] font-semibold text-xl mb-1">{person.name}</h3>
                  <p class="text-gray-600 text-sm max-w-xs break-words">{person.desc}</p>
                </div>
              </div>
          ))}
        </div>
      </section>

      <!-- Section Réseaux Sociaux -->
      <section class="flex flex-col items-center justify-center py-14 bg-white/80 rounded-xl p-8">
        <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-6 text-center">
          Suivez-nous sur les réseaux !
        </h2>
        <div class="text-center mb-6">
          Ne loupez rien de notre actualité, des nouveautés en boutique aux événements spéciaux en nous suivant sur votre réseau social favoris.
        </div>
        <div class="flex flex-row gap-16 items-center mb-8">
          <!-- Icône Facebook -->
          <a
              href="https://www.facebook.com/p/Marc-et-C%C3%A9cile-61575878759493/"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Facebook Marc et Cécile"
              class="group hover:scale-110 transition"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"
                 class="w-16 h-16 text-[#1877f3] group-hover:text-[var(--color-secondary)] transition">
              <path
                  d="M22.675 0h-21.35C.598 0 0 .598 0 1.326v21.348C0 23.402.598 24 1.326 24h11.495V14.709h-3.13v-3.637h3.13V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.142v3.24h-1.918c-1.504 0-1.797.715-1.797 1.763v2.31h3.587l-.467 3.637h-3.12V24h6.116C23.402 24 24 23.402 24 22.674V1.326C24 .598 23.402 0 22.675 0"/>
            </svg>
          </a>

          <!-- Icône Instagram -->
          <a
              href="https://www.instagram.com/marc_et_cecile/"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Instagram Marc et Cécile"
              class="group hover:scale-110 transition"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"
                 class="w-16 h-16 text-[#e1306c] group-hover:text-[var(--color-secondary)] transition">
              <path
                  d="M12 2.163c3.204 0 3.584.012 4.85.07 1.206.058 1.793.25 2.216.415a4.602 4.602 0 0 1 1.604.965c.423.423.748.944.965 1.604.165.423.357 1.01.415 2.216.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.058 1.206-.25 1.793-.415 2.216a4.602 4.602 0 0 1-.965 1.604c-.423.423-.944.748-1.604.965-.423.165-1.01.357-2.216.415-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.206-.058-1.793-.25-2.216-.415a4.602 4.602 0 0 1-1.604-.965 4.602 4.602 0 0 1-.965-1.604c-.165-.423-.357-1.01-.415-2.216C2.175 15.797 2.163 15.417 2.163 12s.012-3.584.07-4.85c.058-1.206.25-1.793.415-2.216a4.602 4.602 0 0 1 .965-1.604A4.602 4.602 0 0 1 5.217 2.648c.423-.165 1.01-.357 2.216-.415C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.012 7.052.07 5.775.128 4.833.316 4.057.55a6.875 6.875 0 0 0-2.487 1.133A6.875 6.875 0 0 0 .55 4.057C.316 4.833.128 5.775.07 7.052.012 8.332 0 8.741 0 12c0 3.259.012 3.668.07 4.948.058 1.277.246 2.219.48 2.995a6.875 6.875 0 0 0 1.133 2.487c.392.392.847.74 1.349.992a6.875 6.875 0 0 0 2.487 1.133c.776.234 1.718.422 2.995.48C8.332 23.988 8.741 24 12 24c3.259 0 3.668-.012 4.948-.07 1.277-.058 2.219-.246 2.995-.48a6.875 6.875 0 0 0 2.487-1.133 6.875 6.875 0 0 0 1.133-2.487c.234-.776.422-1.718.48-2.995.058-1.28.07-1.689.07-4.948 0-3.259-.012-3.668-.07-4.948-.058-1.277-.246-2.219-.48-2.995a6.875 6.875 0 0 0-1.133-2.487A6.875 6.875 0 0 0 19.943.55c-.776-.234-1.718-.422-2.995-.48C15.668.012 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zm0 10.162a3.999 3.999 0 1 1 0-7.999 3.999 3.999 0 0 1 0 7.999zm6.406-11.845a1.44 1.44 0 1 0 0 2.882 1.44 1.44 0 0 0 0-2.882z"/>
            </svg>
          </a>
        </div>
      </section>

      <!-- CONTACT / GOOGLE MAPS -->
      <section class="relative bg-[var(--color-primary)/10] py-12 md:py-20 overflow-hidden bg-white/80 rounded-xl p-8">
        <!-- Décoration subtile en background -->
        <div class="absolute inset-0 bg-gradient-to-tr from-white/5 to-[var(--color-primary)/5] pointer-events-none"></div>

        <div class="container-max grid gap-16 md:grid-cols-2 items-center relative z-10">

          <!-- Texte / adresse -->
          <div class="flex flex-col gap-6">
            <h2 class="text-4xl font-bold text-[var(--color-primary)] mb-2">Notre boutique</h2>
            <p class="text-gray-700 text-lg leading-relaxed">
              <span class="font-semibold">Marc & Cécile Opticiens</span><br/>
              23 Av. de la Victoire<br/>
              59400 Cambrai<br/>
              France
            </p>
            <p class="text-gray-600 text-base">
              Ouvert le Lundi après-midi<br/>
              14h00 - 19h00<br/><br/>
              Du Mardi au Samedi<br/>
              10h00 - 12h30<br/>
              13h30 - 19h00<br/><br/>
              Fermé le Dimanche et les jours fériés.
            </p>

            <div class="flex flex-wrap gap-4 items-center mt-4">
              <a href="tel:+33961002910"
                 class="inline-flex items-center gap-2 text-[var(--color-primary)] hover:underline">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 5h2l2 7-2 4 5 5 4-2 7 2v2a2 2 0 01-2 2h-2a19 19 0 01-14-14V5z"/>
                </svg>
                09 61 00 29 10
              </a>
              <a href="mailto:contact@marcetcecile.fr"
                 class="inline-flex items-center gap-2 text-[var(--color-primary)] hover:underline">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M16 12h2a2 2 0 012 2v6H4v-6a2 2 0 012-2h2m4-4v4m0 0l-4-4m4 4l4-4"/>
                </svg>
                contact@marcetcecile.fr
              </a>
            </div>

            <a href="https://maps.app.goo.gl/ADMNBrK8LL8rerjSA"
               target="_blank"
               class="btn-secondary mt-6 w-max inline-flex items-center gap-2 transition hover:scale-105">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M17.657 16.657L13.414 12.414a4 4 0 10-5.657 5.657l4.243 4.243a4 4 0 005.657-5.657z"/>
              </svg>
              Voir sur Google Maps
            </a>
          </div>

          <!-- Carte Google Map -->
          <div class="w-full h-96 md:h-[32rem] rounded-2xl shadow-2xl overflow-hidden border border-white/20">
            <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2555.3088747085694!2d3.2312529765528955!3d50.17406100722598!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47c2bb25846bdc77%3A0x2160eb5f42a18130!2sMARC%26CECILE%20-%20OPTICIENS!5e0!3m2!1sfr!2sfr!4v1762286124829!5m2!1sfr!2sfr"
                title="Carte Google Maps" width="100%" height="100%" class="border-0"
                allowfullscreen="" loading="lazy"
                referrerpolicy="no-referrer-when-downgrade">
            </iframe>
          </div>

        </div>
      </section>

    </div>
  </main>

</Layout>
