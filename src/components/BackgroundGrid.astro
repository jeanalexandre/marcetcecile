<div id="background-grid" class="background-grid" aria-hidden="true"></div>
<script>
  const gridId = "background-grid";
  const svgs = [
    '/marcetcecile/brand/checkerboard.svg',
    '/marcetcecile/brand/checkerboard-2.svg',
    '/marcetcecile/brand/circle.svg',
    '/marcetcecile/brand/dome.svg',
    '/marcetcecile/brand/multi-wave-2.svg',
    '/marcetcecile/brand/dots.svg',
    '/marcetcecile/brand/dots-2.svg',
    '/marcetcecile/brand/multi-waves.svg',
    '/marcetcecile/brand/double-eyes.svg',
    '/marcetcecile/brand/eye.svg',
    '/marcetcecile/brand/half-o.svg',
    '/marcetcecile/brand/logo-2.svg',
    '/marcetcecile/brand/logo-3.svg',
    '/marcetcecile/brand/sparkle.svg',
    '/marcetcecile/brand/waves.svg',
  ];
  const cols = 7;
  const rowHeight = 180;
  const showChance = 0.40;

  function makeGrid() {
    const gridBg = document.getElementById(gridId);
    if (!gridBg) return;

    // Hauteur = fenêtre
    const vh = window.innerHeight;
    gridBg.style.height = vh + 'px';

    // Génère le bon nombre de lignes
    const rowsNeeded = Math.ceil(vh / rowHeight);

    // Génère la grille des cases
    const gridMap = [];
    let imgIndex = 0;
    for (let r = 0; r < rowsNeeded; r++) {
      gridMap[r] = [];
      for (let c = 0; c < cols; c++) {
        const left = c > 0 && gridMap[r][c-1] !== null && gridMap[r][c-1] !== undefined;
        const up = r > 0 && gridMap[r-1][c] !== null && gridMap[r-1][c] !== undefined;
        if (left || up) {
          gridMap[r][c] = null;
        } else {
          if (Math.random() < showChance) {
            gridMap[r][c] = svgs[imgIndex % svgs.length];
            imgIndex++;
          } else {
            gridMap[r][c] = null;
          }
        }
      }
    }

    gridBg.innerHTML = '';
    gridBg.style.gridTemplateRows = `repeat(${rowsNeeded}, ${rowHeight}px)`;

    for(let r = 0; r < rowsNeeded; r++) {
      for(let c = 0; c < cols; c++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.style.gridRow = (r+1);
        cell.style.gridColumn = (c+1);
        if(gridMap[r][c] !== null) {
          const img = document.createElement('img');
          img.src = gridMap[r][c];
          img.alt = "Background logo";
          cell.appendChild(img);
        }
        gridBg.appendChild(cell);
      }
    }
  }

  window.addEventListener('DOMContentLoaded', makeGrid);
  window.addEventListener('resize', makeGrid);

  // Parallax : translate lent à chaque scroll
  window.addEventListener('scroll', () => {
    const gridBg = document.getElementById(gridId);
    if (gridBg) {
      // Le ratio règle la vitesse (0.5 = 2x moins vite que scroll)
      gridBg.style.transform = `translateY(${window.scrollY * 0.5}px)`;
    }
  });
</script>
<style>
  .background-grid {
    position: fixed;
    top: 0; left: 0; right: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 64px;
    z-index: 0;
    pointer-events: none;
    opacity: 0.13;
    will-change: transform;
  }
  .cell img {
    width: 56px;
    height: 56px;
    opacity: 0.18;
    filter: grayscale(1);
  }
  @media (max-width: 800px) {
    .background-grid {
      grid-template-columns: repeat(4, 1fr);
      gap: 36px;
    }
    .cell img {
      width: 32px;
      height: 32px;
    }
  }
</style>